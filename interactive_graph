# Interactive graph
# Question to address: What factors have the most significant influence on changes in rating and k-factor?

import plotly.express as px

df = pd.merge(
    df_august,
    df_september,
    on="id",
    how="inner",
    suffixes=("_august", "_september")
)

df['rating_change'] = df['rating_september'] - df['rating_august']
df['games_total'] = df['games_september'] + df['games_august']

title_names = df['title_august'].unique()
colors={}

for title in title_names:
  if title in ['GM', 'WGM']:
    colors[title]='blue'
  else:
    colors[title]='#d3d3d3'

fig = px.scatter(
    df,
    x='games_total',
    y='rating_change',
    color='title_august',
    color_discrete_map=colors,
    hover_name='name_august',
    hover_data={
        'fed_august': True,
        'k_august': True,
        'k_september': True,
        'bday_august': True,
        'rating_change': True
    }
)

fig.update_layout(
     title='Top Chess Players Players Show Stable Ratings Over Time',
     xaxis_title='Total Games Played In August and September',
     yaxis_title='Rating Change',
     legend_title_text='Title'
 )

fig.show()
